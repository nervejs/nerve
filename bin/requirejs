#!/usr/bin/env node

const requirejs = require('requirejs');
const fs = require('fs');
const path = require('path');

let pathToRequirejs = './node_modules/requirejs/require.js';
let pathToAxios = '../../../node_modules/axios/dist/axios';

if (!fs.existsSync(pathToRequirejs)) {
    pathToRequirejs = '../requirejs/require.js';
}

if (!fs.existsSync(path.resolve('./tmp/js/es5', pathToAxios + '.js'))) {
    pathToAxios = '../../../../axios/dist/axios';
}

const config = {
    baseUrl: 'tmp/js/es5',
    name: 'nervejs',
    optimize: 'none',
    out: 'dist/nerve.js',
    wrap: {
        startFile: pathToRequirejs
    },
    paths: {
        axios: pathToAxios
    }
};

requirejs.optimize(config, function (results) {
    console.log(results);
});